try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="09728a66-fe3e-4475-9515-63d489775459",e._sentryDebugIdIdentifier="sentry-dbid-09728a66-fe3e-4475-9515-63d489775459")}catch(e){}("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:{}).SENTRY_RELEASE={id:"f7a3b7576263fd8d05d0380dc061abc3dc8c58dc"};(self.webpackChunkbooqable=self.webpackChunkbooqable||[]).push([[173],{6153:function(e,t,s){s.d(t,{A:function(){return h}});var o=s(72505),a=s.n(o),i=s(37584),r=s.n(i),n=s(55373),c=s.n(n);const d=a().create();function p(e){return c().stringify(e,{arrayFormat:"brackets",encodeValuesOnly:!0})}d.interceptors.request.use((e=>(e.paramsSerializer={serialize:p},e))),d.interceptors.request.use((e=>(window.booqablePusherSessionId||=r()(),e.headers.common["X-Booqable-Pusher-Session-Id"]=window.booqablePusherSessionId,e))),d.interceptors.request.use((e=>(window.fingerprint&&(e.headers.common["X-Booqable-Storefront-Token"]=window.fingerprint),e)));var u=d;class l{static prefix="/api";static defaultVersion="boomerang";static _processResponseHeaders=e=>{const t=window.store||window.booqableStore,s=t.getState(),o=e["Session-Expiry-Token"]||e["session-expiry-token"],a=e["Client-Version"]||e["client-version"],i="true"===(e["X-Read-Only-Mode"]||e["x-read-only-mode"]);return s.session?.token!==o&&t.dispatch({type:"SET_TOKEN",payload:{token:o}}),s.session?.clientVersion!==a&&t.dispatch({type:"SET_CLIENT_VERSION",payload:{client_version:a}}),s.session?.readOnlyMode!==i&&t.dispatch({type:"SET_READ_ONLY_MODE",payload:{read_only_mode:i}}),e};static _request=(e,t,s={})=>{let o,a;"get"===e?a=s:o=s;const i=l.path(t,s);delete s.apiVersion;const r=u({method:e,url:i,data:o,params:a,format:"json"}).catch((e=>{switch(e?.response?.status){case 401:window.skipUnsavedChangesCheck=!0,window.location.reload();break;case 503:throw(window.store||window.booqableStore).dispatch({type:"SERVICE_UNAVAILABLE_ERROR",payload:{error:e.response.data}}),e;default:throw e}}));return r.then((e=>{l._processResponseHeaders(e.headers)})),r};static get=(e,t={})=>l._request("get",e,t);static post=(e,t={})=>l._request("post",e,t);static patch=(e,t={})=>l._request("patch",e,t);static put=(e,t={})=>l._request("put",e,t);static delete=(e,t={})=>l._request("delete",e,t);static getCollection=(e,t={})=>l.get(e,t);static getResource=(e,t,s={})=>t?l.get(`${e}/${t}`,s):l.get(`${e}`,s);static createResource=(e,t={})=>{const s=t.apiVersion??l.defaultVersion;if(3===s||"boomerang"===s){const{attributes:s,...o}=t,a={...o,data:{type:e,attributes:s}};return l.post(e,a)}return l.post(e,t)};static updateResource=(e,t,s={})=>{const o=s.apiVersion??l.defaultVersion;if(3===o||"boomerang"===o){const{attributes:o,...a}=s,i={...a,data:{type:e,id:t,attributes:o}};return l.patch(`${e}/${t}`,i)}return l.put(`${e}/${t}`,s)};static deleteResource=(e,t,s={})=>l.delete(`${e}/${t}`,s);static path=(e,t={})=>{const s=t.apiVersion??l.defaultVersion,o=`${l.prefix}/${s}`;return e&&e.length>0?`${o}/${e}`:o}}var h=l},53067:function(e,t,s){var o=s(68238),a=s(42088),i=s(9404),r=s.n(i),n=s(2543),c=s(88267);t.A=class{static models={};static __modelCache={};static reducer(e={},t,s){const i={};return(0,n.forEach)(this.models,((e,t)=>{i[(0,a.fG)(t)]=e.getReducer()})),i.pendingRequests=(e=r().List(),t)=>{let o,a;return c.EventTracker.trackDispatch(s,t),t.type.endsWith("_START")&&(a=t.type.replace("_START",""),e=e.push(a)),t.type.endsWith("_ERROR")&&(a=t.type.replace("_ERROR",""),o=e.indexOf(a),e=e.delete(o)),t.type.endsWith("_SUCCESS")&&(a=t.type.replace("_SUCCESS",""),o=e.indexOf(a),e=e.delete(o)),e},(0,o.HY)(i)(e,t)}}},81302:function(e,t,s){s.d(t,{A:function(){return D}});var o=s(2543),a=s(18377),i=s(42088),r=s(6153),n=s(53067),c=s(9404),d=s.n(c),p=s(20311),u=s.n(p),l=s(38639);class h{constructor(e,t,s={}){this.model=e,this.name=t,this.primaryKey=s.primaryKey||"id",this.namespace=s.namespace||window,this.modelName=s.model||(0,i.L8)((0,i.ES)(t)),this.__register(),this.__bind()}getAssociation(e,t){return e.prototype._associations[t]}associatedModel(){return this.namespace[this.modelName]}__register(){this.model.prototype._associations||={},this.model.prototype._associations[this.name]=this}__bind(){const e=this;this.model.prototype[`get${(0,i.PT)(this.name)}`]=function(){return e.getResult(this)}}}class y extends h{constructor(e,t,s={}){super(e,t,s),this.key=s.key||`${this.name}_${this.primaryKey}`}getResult(e){return this.associatedModel().collection.getById(e.get(this.key))}}class _ extends h{constructor(e,t,s={}){super(e,t,s),this.foreignKey=s.foreignKey,this.through=s.through??null}getRecords(e,t,s){return this.recordsSelector||=(0,o.memoize)(((e,t,s)=>t.getAll(s)),((e,t)=>[e.id,e.hashCode(),t.hashCode()].join("-"))),this.recordsSelector(e,t,s)}getResult(e){const t={};if(this.through){const s=this.getAssociation(this.model,this.through),o=this.getAssociation(s.associatedModel(),this.name),a=o.associatedModel(),i=s.getResult(e).map((e=>e.id)).toArray();return t[o.foreignKey]=i,this.getRecords(e,a.collection(),t)}return t[this.foreignKey]=e.id,this.getRecords(e,this.associatedModel().collection(),t)}}class f extends _{getResult(e){return super.getResult(e).first()}}const m=(e,t)=>{try{t.forEach((t=>E(e,t)))}catch{}},E=(e,t)=>{Object.defineProperty(e,t,{get(){return this.get(t)},set(e){u()(this.__ownerID,"Cannot set on an immutable record"),this.set(t,e)}})};class g extends(d().Record({})){constructor(e){super(),e||={};const t=(0,o.merge)({},this.constructor.prototype._defaultValues);(0,o.forOwn)(e,((e,s)=>{t[s]=void 0}));const s=Object.keys(t);m(this.constructor.prototype,s),this.constructor.prototype.size=s.length,this.constructor.prototype._name=name,this.constructor.prototype._keys=s,this.constructor.prototype._defaultValues=t,m(this,Object.keys(e)),this._map=d().Map(e)}static defaultValues(e={}){return this.prototype._defaultValues||={},(0,o.forOwn)(e,((e,t)=>{this.prototype._defaultValues[t]=e})),this.prototype._defaultValues}static collection(){return this._collection||new l.A(this)}static hasMany(e,t={}){return new _(this,e,t)}static hasOne(e,t={}){return new f(this,e,t)}static belongsTo(e,t={}){return new y(this,e,t)}has(){return!0}toJSON(){return this._map.toJS()}toJS(){return this._map.toJS()}hydrate(e){if(new Date(e.updated_at)<new Date(this.updated_at))return this;const t=this.withMutations((t=>{(0,o.forOwn)(e,((e,s)=>{const a=this.get(s);(0,o.isEqual)(e,a)||t.set(s,e)}))}));return m(t,Object.keys(t.toJS())),t}}var T={actionMethod:(e,t={})=>(t.apiVersion=t.apiVersion??e.options.apiVersion,t.stats?t.stats.total="count":t.stats={total:"count"},r.A.getCollection(e.pluralName,t)),reduceMethod:(e,t,s)=>{switch(s.type){case e.actionTypes.FETCH_ALL_START:return t.set("isLoadingCollection",!0);case e.actionTypes.FETCH_ALL_ERROR:case e.actionTypes.FETCH_ALL_SUCCESS:return t.set("isLoadingCollection",!1)}}},R={actionMethod:(e,t={})=>{const{id:s,...o}=t;return o.apiVersion=o.apiVersion??e.options.apiVersion,r.A.getResource(e.pluralName,s,o)},reduceMethod:(e,t,s)=>{switch(s.type){case e.actionTypes.FETCH_START:return t.set("isLoadingResource",!0);case e.actionTypes.FETCH_ERROR:case e.actionTypes.FETCH_SUCCESS:return t.set("isLoadingResource",!1)}}},S={actionMethod:(e,t={})=>((t=(0,o.merge)({},t))[e.singularName]=t.attributes,t.apiVersion=t.apiVersion??e.options.apiVersion,r.A.createResource(e.pluralName,t)),reduceMethod:(e,t,s)=>{const a=s?.payload?.options||{},i=a.id;switch(s.type){case e.actionTypes.CREATE_START:if(a.id){const e={id:a.id,isBusy:!0,pendingCreate:!0};a.attributes&&(0,o.extend)(e,a.attributes),t=t.add(a.id,e,{temporary:!0})}return t;case e.actionTypes.CREATE_ERROR:if(a.id){const e={isBusy:!1,pendingCreate:!0,hasError:!0,errorData:s?.payload?.error};t=t.update(a.id,e)}return t;case e.actionTypes.CREATE_SUCCESS:if(a.id){if(s?.payload?.records){const e=Object.keys(s.payload.records)[0];t=t.update(e,{tempID:i})}t=t.delete(a.id)}return t}}},A={actionMethod(e,t={}){return(t=(0,o.merge)({},t))[e.singularName]=t.attributes,t.apiVersion=t.apiVersion??e.options.apiVersion,r.A.updateResource(e.pluralName,t.id,t)},reduceMethod(e,t,s){const a=s?.payload?.options||{},i=a.id;switch(s.type){case"ORM_RESET_RECORD":{const o=s?.payload?.record;return o&&e===o.constructor&&(t=t.update(o.id,e._asyncDefaultValues)),t}case e.actionTypes.UPDATE_START:if(i){const e={isBusy:!0,pendingUpdate:!0};a.optimistic&&a.attributes&&(0,o.extend)(e,a.attributes),t=t.update(i,e)}return t;case e.actionTypes.UPDATE_ERROR:return i&&(t=t.update(i,{isBusy:!1,pendingUpdate:!0,hasError:!0,errorData:s?.payload?.error}),a.optimistic&&console.log("Record was updated optimistically but the action failed, what to do now?")),t;case e.actionTypes.UPDATE_SUCCESS:return i&&(t=t.update(a.id,{isBusy:!1,pendingUpdate:!1})),t}}},C=s(58156),b=s.n(C),w={actionMethod:(e,t={})=>{if(t.apiVersion=t.apiVersion||e.options.apiVersion,3===t.apiVersion){const s=t.ids.map((t=>({type:e.pluralName,id:t})));return r.A.patch(`${e.pluralName}/positions`,{apiVersion:3,data:s})}return r.A.post(`${e.pluralName}/update_positions`,t)},reduceMethod:(e,t,s)=>{const o=b()(s,"payload.options",{});switch(s.type){case e.actionTypes.UPDATE_POSITIONS_START:{const e=b()(o,"ids",[]).map(((e,t)=>({id:e,position:t+1})));return t.hydrate(e)}case"SORTINGS_CREATE_START":{const s=b()(o,"attributes.type");if(s!==e.pluralName)return null;const a=b()(o,"attributes.ids",[]),i=[];return"products"===s?a.forEach(((e,s)=>{t.getById(e).sorting_weight!==s+1&&i.push({id:e,sorting_weight:s+1})})):a.forEach(((e,s)=>{t.getById(e).position!==s+1&&i.push({id:e,position:s+1})})),t.hydrate(i)}}}},V={actionMethod:(e,t={})=>(t.apiVersion=t.apiVersion??e.options.apiVersion,r.A.deleteResource(e.pluralName,t.id,t)),reduceMethod:(e,t,s)=>{const o=s?.payload?.options||{},a=o.id;switch(s?.type){case e.actionTypes.DELETE_START:return a&&(t=t.update(a,{isBusy:!0,pendingDelete:!0}),o.optimistic&&(t=t.delete(a))),t;case e.actionTypes.UPDATE_ERROR:return a&&(t=t.update(a,{isBusy:!1,pendingDelete:!0,hasError:!0,errorData:s?.payload?.error}),o.optimistic&&console.log("Record was deleted optimistically but the action failed, what to do now?")),t;case e.actionTypes.DELETE_SUCCESS:return a&&t.getById(a)&&(t=t.update(a,{isBusy:!1,pendingDelete:!1})),t.delete(a)}}},O={actionMethod:(e,t={})=>(t.apiVersion=t.apiVersion??e.options.apiVersion,t.stats?t.stats.total="count":t.stats={total:"count"},r.A.getCollection(e.pluralName,t)),reduceMethod:(e,t,s)=>{switch(s.type){case e.actionTypes.FETCH_ALL_START:return t.set("isLoadingCollection",!0);case e.actionTypes.FETCH_ALL_ERROR:case e.actionTypes.FETCH_ALL_SUCCESS:return t.set("isLoadingCollection",!1)}}},N={fetchAll:T,fetch:R,create:S,update:A,updatePositions:w,delete:V,refresh:O},D=(e,t={})=>{if(t.apiVersion===r.A.defaultVersion)throw"Only specify apiVersion when different from the default.";const s=t.singularName||(0,i.z9)(e),c=t.pluralName||(0,i.fG)(e),d=["START","SUCCESS","ERROR"];t.normalizeSingularKey||=s;class p extends g{static store(){return window.store||window.booqableStore}static actionsForBind(){return this.boundActions||(this.boundActions||={},(0,o.forEach)(this.actions,((e,t)=>{this.boundActions[t]=(...t)=>s=>e(...t,s)}))),this.boundActions}static hydrate(e,t={}){if(!(0,o.isEmpty)((0,o.trim)(e))){const s=this._normalizeResponse({data:e}),o={response:e,normalizedResponse:s,options:t,records:s.entities[c]};return p.store().dispatch({type:this.actionTypes.FETCH_ALL_SUCCESS,payload:o})}}static createStrategy(e,t,s){if(this.strategies||={},"object"===typeof t){const e=t;t=e.action,s=e.reducer}const o=(0,i.z9)(e).toUpperCase();t&&this.createAction(o,((...e)=>t(this,...e))),s?this.createReducer(s):this.createReducer(((t,s,a)=>{const r=a?.payload?.options||{};if(r.id&&s.getById(r.id)){const n=t=>(0,i.PT)(`${t}_${e}`,!1);switch(a.type){case t.actionTypes[`${o}_START`]:{const e={isBusy:!0,[n("pending")]:!0,[n("succss")]:!1};s.update(r.id,e);break}case t.actionTypes[`${o}_ERROR`]:{const e={isBusy:!1,hasError:!0,errorData:a?.payload?.error,[n("pending")]:!1,[n("success")]:!1,[n("error")]:!0,[n("errorData")]:a?.payload?.error};s.update(r.id,e);break}case t.actionTypes[`${o}_SUCCESS`]:{const e={isBusy:!1,hasError:!1,errorData:void 0,[n("pending")]:!1,[n("success")]:!0,[n("error")]:!1,[n("errorData")]:void 0};s.update(r.id,e);break}}}}))}static createReducer(e){this.reducers||=[],this.reducers.push(e)}static createAction(e,t){this.actions||={},this._createActionTypes(e),this._createActionCreators(e,"records");const s=(0,i.PT)((0,i.z9)(e),!1);this.actions[s]=(e,a)=>(a||=p.store().dispatch,a(this.actionCreators[`${s}Start`]({options:e})),new Promise(((i,r)=>t(e).then((t=>{let r;if(!(0,o.isEmpty)((0,o.trim)(t.data))){const s=this._normalizeResponse(t,e);r={response:t.data,normalizedResponse:s,options:e,records:s.entities[c]}}else r={response:t.data,options:e};this._deleteNestedRelations(e?.attributes,a),i(a(this.actionCreators[`${s}Success`](r)))}),(t=>{const o=this._normalizeResponse(t.response,e),i={error:t.response.data,normalizedResponse:o,options:e};a(this.actionCreators[`${s}Error`](i)),r(t.response.data.errors||t.response.data.error)})))))}static schema(){return this._schema||(t.schema?this._schema=t.schema:(this._schema=new a.Sj(c),(0,o.forEach)(t.belongsTo,((e,t)=>{const s=(0,i.z9)(t),o=n.A.models[s];o&&this._schema.define({[s]:o.schema()})})),(0,o.forEach)(t.hasOne,((e,t)=>{const s=(0,i.z9)(t),o=n.A.models[s];o&&this._schema.define({[s]:o.schema()})})),(0,o.forEach)(t.hasMany,((e,t)=>{const s=e.modelName||t,o=(0,i.z9)(s),r=(0,i.z9)(t),c=n.A.models[(0,i.ES)(o)];c&&this._schema.define({[r]:(0,a.jk)(c.schema())})})))),this._schema}static getReducer(){return(e,t)=>{if(e||=this.collection(),"ORM_INVALIDATE_CACHE"===t.type){-1===(t.payload?.skip||[]).indexOf(c)&&(e=e.invalidateCache({name:c}))}t.type===this._actionType("refresh","success")&&(e=e.clearCache());const a=t?.payload?.normalizedResponse?.entities[c];if(a)e=e.hydrate(a);else{const a=t?.payload?.response;if(a){let i,r;if(a?.data?i=!0:(r=a?.[s]&&!(0,o.isEmpty)((0,o.trim)(a?.[s])),i=a?.[c]&&!(0,o.isEmpty)((0,o.trim)(a?.[c]))),i||r){const s=this._normalizeResponse({data:a},t?.payload?.options),o=s?.entities[c];o&&(e=e.hydrate(o))}}}return(0,o.forEach)(this.reducers,(s=>{const o=s(this,e,t);o&&(e=o)})),e}}static _actionType(e,t="SUCCESS"){return[c,e,t].join("_").toUpperCase()}static _actionTypes(...e){const t={};return e.forEach((e=>{d.map((t=>this._actionType(e,t))).forEach((e=>{const s=e.replace(`${c}_`.toLocaleUpperCase(),"");t[s]=e}))})),t}static _createActionTypes(...e){return this.actionTypes||={},(0,o.forEach)(this._actionTypes(...e),((e,t)=>{this.actionTypes[t]=e})),this.actionTypes}static _createActionCreator(e,t,s){this.actionCreators||={};const o=(0,i.PT)((0,i.z9)(e),!1);this.actionCreators[o]=(e={})=>({type:t,payload:e})}static _normalizeResponse(e,t={}){const s=e?.data||{};return s.data?this._normalizeJsonApiResponse(s,t):this._normalizeLegacyResponse(s)}static _normalizeJsonApiResponse(e,t={}){const s={},a=(e,t,s,a)=>{const i=(e=>{if(e=e.toLowerCase(),n.A.__modelCache[e])return n.A.__modelCache[e];const t=(0,o.find)(n.A.models,((t,s)=>[t.pluralName,t.singularName,t.options.normalizeSingularKey].indexOf(e)>=0));return n.A.__modelCache[e]=t,t})(s||t.type);i&&(s=a||i.stateKey||i.pluralName,e[s]||={},e[s][t.id]=(0,o.merge)({id:t.id},t.attributes),(0,o.forEach)(t.relationships,((o,a)=>{let i;Array.isArray(o.data)?i=o.data.map((e=>e.id)):o.data&&(i=o.data.id),i&&(e[s][t.id][a]=i,e[s][t.id][`${a}_ids`]=i)})))};if(Array.isArray(e.data)?(0,o.forEach)(e.data,(e=>{a(s,e,null,t?.stateKey)})):(a(s,e.data,null,t?.stateKey),e.data?.attributes?.type?.includes("::")&&a(s,e.data,e.data.attributes.type.split("::")[0])),e.included){(0,o.forEach)(e.included,(e=>{a(s,e)}));const t={};(0,o.forEach)([e.data].flat(),(e=>{(0,o.forEach)(e.relationships,((e,s)=>{let a;s=(0,i.fG)(s),Array.isArray(e.data)?a=e.data.map((e=>e.id)):e.data&&(a=[e.data.id]),(0,o.forEach)(a,(e=>{t[e]=s}))}))})),(0,o.forEach)(e.included,(e=>{const o=t[e.id];a(s,e,null,o)}))}return{entities:s}}static _normalizeLegacyResponse(e){const t={};return(0,o.forEach)(n.A.models,((s,o)=>{s&&(e[s.pluralName]||e[s.options.normalizeSingularKey])&&(t[s.pluralName]=(0,a.jk)(s.schema()),t[s.options.normalizeSingularKey]=s.schema())})),(0,a.S8)(e,t)}static _createActionCreators(e){this._createActionCreator(`${e}_START`,this.actionTypes[`${e}_START`]),this._createActionCreator(`${e}_SUCCESS`,this.actionTypes[`${e}_SUCCESS`]),this._createActionCreator(`${e}_ERROR`,this.actionTypes[`${e}_ERROR`])}static _deleteNestedRelations(e,s){if(!t.hasMany)return;const a=[];(0,o.forEach)(t.hasMany,((e,t)=>{a.push(t)}));const i=[];e&&(0,o.forEach)(a,(t=>{e[`${t}_attributes`]&&(0,o.forEach)(e[`${t}_attributes`],(e=>{e._destroy&&i.push({model:t.toUpperCase(),id:e.id})}))})),(0,o.forEach)(i,(e=>{s({type:`${e.model}_DELETE_START`,payload:{options:{id:e.id,optimistic:!0}}})}))}}return(0,o.forEach)(N,((e,t)=>{p.createStrategy(t,e.actionMethod,e.reduceMethod)})),(0,o.forEach)(t.belongsTo,((e,t)=>{p.belongsTo(t,e)})),(0,o.forEach)(t.hasMany,((e,t)=>{p.hasMany(t,e)})),(0,o.forEach)(t.hasOne,((e,t)=>{p.hasOne(t,e)})),p.singularName=s,p.pluralName=c,p.options=t,p._asyncDefaultValues={isBusy:!1,hasError:!1,errorData:void 0,pendingUpdate:!1,pendingCreate:!1,pendingDelete:!1},p.defaultValues(p._asyncDefaultValues),t.defaultValues&&p.defaultValues(t.defaultValues),n.A.models[s]=p,p}},22390:function(e,t,s){s.d(t,{A:function(){return p}});var o=s(9404),a=s.n(o),i=s(98103),r=s.n(i);const n=(e,t="")=>{const s={};for(const o in e){"object"===typeof e[o]&&!Array.isArray(e[o])&&null!==e[o]?Object.assign(s,n(e[o],t+"."+o)):s[(t+"."+o).replace(/^\./,"")]=e[o]}return s};var c=n;const d=new(a().Map)({});var p=(e,t)=>{switch(e=e||d,t.type){case"SETTINGS_INITIALIZED":case"SETTINGS_CHANGED":for(const s in t.payload.settings){const o=t.payload.settings[s];e=e.set(s,o)}return e;case"SESSIONS_FETCH_SUCCESS":{const s=t.payload.response.included.find((e=>"settings"===e.type)).attributes,o=c(s);r().settings={currency:s.currency,number:{precision:0,decimal:s.currency.decimal,thousand:s.currency.thousand}};for(const t in o){const s=o[t];e=e.set(t,s)}return e}default:return e}}}}]);
//# sourceMappingURL=173-95e309c5f0e3609abd7a.js.map