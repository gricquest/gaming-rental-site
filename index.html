<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>GRICQUEST</title>
  <!-- Favicon -->
  <link rel="icon" href="Gricquest-icon.PNG" type="image/x-icon">
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <!-- Flatpickr CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <!-- Custom CSS -->
  <style>
    /* Custom CSS */
    body {
      background-color: #f8f9fa;
    }

    .hero-section {
      background-image: url('Background_1.PNG');
      background-size: cover;
      background-position: center;
      padding: 150px 0;
      color: #fff;
      text-align: center;
      position: relative;
    }

    .hero-section::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
    }

    .hero-section .container {
      position: relative;
      z-index: 1;
    }

    .date-picker .input-group {
      max-width: 600px;
      margin: 0 auto;
    }

    .game-card {
      margin-bottom: 30px;
    }

    .card-img-top {
      height: 200px;
      object-fit: cover;
    }

    .navbar .btn {
      margin-left: 10px;
    }

    .search-input {
      width: 250px;
      margin-right: 10px;
    }

    @media (max-width: 768px) {
      .search-input {
        width: 100%;
        margin-bottom: 10px;
      }

      .navbar .btn {
        width: 100%;
        margin-left: 0;
      }
    }

    .navbar-text {
      color: #fff;
      margin-right: 15px;
    }

    .navbar {
  position: fixed;
  top: 0;
  width: 100%;
  z-index: 1000; /* Ensure the navbar stays on top of other content */
    }
    #cart-items .media {
  border-bottom: 1px solid #ddd;
  padding-bottom: 10px;
    }
    
    .game-card {
  margin-bottom: 30px;
}

.nav-tabs .nav-link {
  color: #007bff;
}

.nav-tabs .nav-link.active {
  color: #495057;
  background-color: #fff;
  border-color: #dee2e6 #dee2e6 #fff;
}

.navbar-nav .nav-link {
  color: black !important; /* Change text color to black */
  font-size: 1rem; /* Increase font size */
}

  </style>
  <script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"></script>
  
</head>
<body>
  <!-- Navigation Bar -->
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <a class="navbar-brand" href="#">
      <img src="Name.PNG" alt="Gricquest" style="height: 80px;">
    </a>
    <div class="d-flex align-items-center ml-auto">
      <form class="form-inline mr-2 d-block d-lg-none" onsubmit="searchAllGames(); return false;">
        <input class="form-control mr-sm-2 search-input" type="search" id="search-input-mobile" placeholder="Search games" aria-label="Search">
        <button class="btn btn-outline-dark" type="submit">Search</button>
      </form>
      <button class="btn btn-outline-dark ml-2 d-block d-lg-none" onclick="showCart()">
        Cart (<span id="cart-count-mobile">0</span>)
      </button>
      <span class="navbar-text ml-2 d-block d-lg-none" id="user-name-display-mobile"></span>
      <button class="btn btn-outline-dark ml-2 d-block d-lg-none" id="auth-button-mobile" onclick="openAuthModal()">Sign In</button>
      <button class="navbar-toggler ml-2" type="button" data-toggle="collapse" data-target="#navbarNav"
        aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>
    <div class="collapse navbar-collapse" id="navbarNav">
      <!-- Mobile menu: show only on mobile -->
      <ul class="navbar-nav d-lg-none">
        <li class="nav-item">
          <a class="nav-link" href="./index.html">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="./discover-further.html">Discover Further</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="./MembershipOptions.html">Membership</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="./products.html">Products</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="./FAQ.html">FAQ</a>
          </li>
        <li class="nav-item">
          <a class="nav-link" href="./contact.html">Contact</a>
        </li>
      </ul>
      <!-- Desktop menu: show only on desktop/web -->
      <ul class="navbar-nav ml-auto d-none d-lg-flex align-items-lg-center">
        <li class="nav-item">
          <a class="nav-link" href="./index.html">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="./discover-further.html">Discover Further</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="./MembershipOptions.html">Membership</a>
        </li>        
        <li class="nav-item">
          <a class="nav-link" href="./FAQ.html">FAQ</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="./products.html">Products</a>
          </li>
        <li class="nav-item">
          <a class="nav-link" href="./contact.html">Contact</a>
        </li>
        <li class="nav-item">
          <form class="form-inline mr-2" onsubmit="searchAllGames(); return false;">
            <input class="form-control mr-sm-2 search-input" type="search" id="search-input" placeholder="Search games" aria-label="Search">
            <button class="btn btn-outline-dark" type="submit">Search</button>
          </form>
        </li>
        <li class="nav-item">
          <button class="btn btn-outline-dark ml-2" onclick="showCart()">
            Cart (<span id="cart-count">0</span>)
          </button>
        </li>
        <li class="nav-item">
          <span class="navbar-text ml-2" id="user-name-display"></span>
        </li>
        <li class="nav-item">
          <button class="btn btn-outline-dark ml-2" id="auth-button" onclick="openAuthModal()">Sign In</button>
        </li>
      </ul>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="hero-section">
    <div class="container">
      <h1 class="display-4">A Game on Demand Service for Tabletop Games</h1>
      <p class="lead">Are you eager to create and cherish special moments with friends and family? Perhaps you want to bond over quality, screen-free time, host a Game Night challenge, or throw a themed or casual party? Maybe you're eager to try that ONE game before committing to adding it to your collection? Look no further than GricQuest. Dive into our diverse selection of tabletop games, including board, card, dice, tiles, and more. Our collection is regularly updated with the latest, most popular, and even vintage and rare collector's editions. From keen tots to serious tabletop gamers, GricQuest caters to a range of interests. You can rent games for specific durations, subscribe to our monthly mystery box rentals, or collaborate with us to create a fantastic experience for your event. Unleash the fun with GricQuest - Where every roll, move, and strategy comes to life!</p>
      <div class="date-picker">
        <div class="input-group mb-3 flex-column flex-md-row">
          <input type="text" id="rent-date" class="form-control mb-2 mb-md-0" placeholder="Rental Date">
          <input type="text" id="return-date" class="form-control mb-2 mb-md-0 ml-md-2" placeholder="Return Date">
          <div class="input-group-append mt-2 mt-md-0 ml-md-2">
            <button class="btn btn-primary" type="button" onclick="loadAvailableGames()">Search Availability</button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Main Content -->
<!--   <main class="container mt-5">
    <div id="game-list" class="row"> -->
      <!-- Game cards will be inserted here -->
  <!--   </div>
  </main> -->
<!-- Main Content -->
<!-- Main Content -->
<main class="container mt-5">
  <!-- Genre Tabs -->
  <ul class="nav nav-tabs" id="genre-tabs" role="tablist">
    <!-- Tabs will be dynamically inserted here -->
  </ul>

  <!-- Tab Content -->
  <div class="tab-content" id="genre-tabContent">
    <!-- Tab panes will be dynamically inserted here -->
  </div>
</main>

  

  <!-- Sign-In Modal -->
  <div class="modal fade" id="signInModal" tabindex="-1" aria-labelledby="signInModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Sign In</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <!-- Sign-In Form -->
          <div class="form-group">
            <label for="signin-email">Email address</label>
            <input type="email" class="form-control" id="signin-email" placeholder="Enter email">
          </div>
          <div class="form-group">
            <label for="signin-password">Password</label>
            <input type="password" class="form-control" id="signin-password" placeholder="Password">
          </div>
          
          <button type="button" class="btn btn-primary" onclick="signIn()">Sign In</button>
          <p class="mt-3">Don't have an account? <a href="#" onclick="showSignUp()">Sign Up</a></p>
        </div>
      </div>
    </div>
  </div>

<!-- Cart Modal -->
<div class="modal fade" id="cartModal" tabindex="-1" aria-labelledby="cartModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Your Cart</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
    
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <!-- Cart Items -->
        <div id="cart-items">
          <!-- Cart items will be populated here -->
        </div>
        <div class="form-check mt-3">
          <input type="checkbox" class="form-check-input" id="agree-terms">
          <label class="form-check-label" for="agree-terms">
            I agree to the <a href="#" data-toggle="modal" data-target="#termsModal">terms and conditions</a>
          </label>
        </div>
        <div class="text-right">
          <!-- <button class="btn btn-primary" onclick="checkout()">Proceed to Checkout</button>  -->
          <button class="btn btn-primary" id="checkout-button" disabled>Checkout</button>
        </div> 
      </div>
    </div>
  </div>
</div>
<!-- Terms and Conditions Modal -->
<div class="modal fade" id="termsModal" tabindex="-1" role="dialog" aria-labelledby="termsModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="termsModalLabel">Terms and Conditions</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <!-- Insert your terms and conditions text here -->
        <p><b>Rental Agreement - Terms and Conditions:</b><br>
          The renter of the games agrees and accepts to the below terms and conditions, and considers this as a rental agreement for the possession of the games rented from GRICQuest. Failure to read and comply with this terms and agreements will result in violation of the same.<br>
          The games listed in cart are rented out for a tenure of 5 days. The rental tenure for these games can be extended for maximum of another 5 days, charged at 20% of the base rental charge per day. The renter agrees to the below terms and agreements:<br>
          •	<b>Data Storage</b> - All payments for reservations must be made using a card, which will be done through the payment gateway (Stripe) used by the hosted server. Your full name, address, and contact number are stored at our end during the checkout process. We do not store or have access to your card details entered. <br>
          •	<b>Payment Authorization </b> - An invoice will be issued for the rental fee and the full MSRP of the games being rented. The rental fee will be charged immediately to your card, and a hold will be placed on your card for the MSRP amount. Upon returning the game in the agreed condition within the rental period, the remaining invoice will be satisfied, and the hold will be canceled. If otherwise, charges are applied before releasing the hold on your card. You authorize us to charge your card for any extensions, late fees accrued, game loss/damage in addition to your rental tenure charge.<br>
          •	<b>Delay/No Communication Charges </b>- Late fees will be automatically applied for the next 5 days at the rate of 50% of the base rental charge per day for the next 5 days. (eg, a Game rented at $15 for 5 days, would have a late fee of $7.5/day for the next 1-5 days until the game is received.) Failure to communicate/return the games within the late period, authorizes us to charge the full MSRP of the game, along with any accrued late fees during this period for the rented games, and any further rentals will be restricted.<br>
          •	<b>Order Cancellation </b>- The renter may be able to cancel the order for a full refund 48 hours before the rental start date. If not, your card will be charged for the rental duration even if the products are not picked up/delivered.<br>
          •	<b>Game Condition </b>- You agree to return the game in the EXACT condition in which you received it, with all of its pieces, the parts bagged, cards still in sleeves, etc. No alterations or attachments may be made to the game. As a courtesy, we ask you to organize the components in the game as received. We reserve the right to charge your credit card for the full MSRP of the game in case of irreparable damage, or partially for loss of components/damage, upon inspection of the returned game. This includes, but is not limited to, damage by Fire, Food/Water/Liquids/Bodily Fluids, Human or Animal Damages to game / box, and Lost Pieces or components. <br>
          •	<b>Lending and Ownership</b> - You agree to keep the game in your possession and not lend or sub-rent it to anyone else during your rental tenure.<br>
          •	<b>Safety & Choking Hazard Warning</b> - Games rented from us are intended to be used by audiences as indicated by the manufacturer of the games, exercising caution and adult supervision as needed, at your own risk. By renting a game, you acknowledge that it may contain several tiny pieces, plastic bags, and/or other components that may pose a choking hazard to small children if left unattended. The game’s packaging, inserts and instruction manuals usually contain age recommendations and warnings regarding safety listed by the manufacturer of the games, which you would need to adhere for your personal safety and the safety of those who may come in contact with the game while it is in your possession. You can also check with us on this aspect, before renting out the games. By using this rental service, you accept full responsibility for the safe use of any game rented until it is returned.<br>
          •	<b>Rights reserved to cancel an order</b> - We reserve the rights at GRICQuest to cancel or partially fulfil the order. In which case, the refund is made in accordance to the games rented or withheld.<br>
          •	<b>Service Restriction</b> - We are currently only providing services to a restricted number of zip codes, due to our current logistics. The Self-pickup and self-drop off of the games are from Mountain House (zipcode - 95391). Delivery/Pickup services options currently cater to the following zipcodes of Mountain House, Tracy, Livermore, Dublin and Pleasanton cities (94551, 94566, 94568, 94588, 94550, 95391, 95376, 95377, 95304). If you don't find your zip codes listed, kindly reach out to check for a possibility of delivery/pickup.<br>
          <b>All communications should be directed via email to gricquest@gmail.com or by calling/texting at +1(925)236-0441. </b> <br>
          </p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>




  <!-- Sign-Up Modal -->
  <div class="modal fade" id="signUpModal" tabindex="-1" aria-labelledby="signUpModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Sign Up</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
    
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <!-- Sign-Up Form -->
          <div class="form-group">
            <label for="signup-email">Email address</label>
            <input type="email" class="form-control" id="signup-email" placeholder="Enter email">
          </div>
          <div class="form-group">
            <label for="signup-password">Password</label>
            <input type="password" class="form-control" id="signup-password" placeholder="Password">
          </div>
          <!-- Sign-Up Form -->
<div class="form-group">
  <label for="signup-name">Full Name</label>
  <input type="text" class="form-control" id="signup-name" placeholder="Enter your name">
</div>
<div class="form-group">
  <label for="signup-phone">Phone Number</label>
  <input type="text" class="form-control" id="signup-phone" placeholder="Enter your phone number">
</div>

          <button type="button" class="btn btn-primary" onclick="signUp()">Sign Up</button>
        </div>
      </div>
    </div>
  </div>

  <section class="text" id="section-text" data-section="true" data-section-key="text"><link rel="stylesheet" type="text/css" href="./text-c69cfc7f7c4c0e9119e001940ed9a7c979af67e4de966e906b6338580a792035.css">

    <div class="text__wrapper palette-three text__wrapper--padding-top text__wrapper--padding-bottom" id="text-text" style="--padding-top: 24px;--padding-bottom: 24px;--padding-top-mobile: 18px;--padding-bottom-mobile: 18px;--text-align: center;">
      <div class="text__container container"><div class="text__content bq-content rx-content"><p>Re<b></b>nt Your Fa<b></b>vourite Tableto<b></b>p Games in 3 easy steps</p></div></div>
    </div>
    
    
    </section>
    <section class="columns" data-section="true" data-section-key="columns" id="section-columns"><link href="./images/columns-e73bfd267d943e909f53557defb9426280f8b9dc38cc1b9306c01b723d815ecf.css" rel="stylesheet" type="text/css"/>
      <div class="columns__wrapper palette-two columns__wrapper--padding-top columns__wrapper--padding-bottom" style="--padding-top: 24px;--padding-bottom: 24px;--padding-top-mobile: 18px;--padding-bottom-mobile: 18px;--grid-element: 3;">
      <div class="columns__container container">
      <div class="columns__grid"><div class="columns__item" id="column_914694"><div class="columns__image-wrapper"><img alt="" class="columns__image ls-is-cached lazyloaded" data-src="images/2f1bcb08-6e65-5e30-929c-c2b0448ba5cb-f244bebc52172d82a68b84cd9a1eab7c7a4fa4fec57b14adb53b5ab12e8d9c58.jpg" data-srcset="images/2f1bcb08-6e65-5e30-929c-c2b0448ba5cb-f244bebc52172d82a68b84cd9a1eab7c7a4fa4fec57b14adb53b5ab12e8d9c58.jpg 80w, images/2f1bcb08-6e65-5e30-929c-c2b0448ba5cb-f244bebc52172d82a68b84cd9a1eab7c7a4fa4fec57b14adb53b5ab12e8d9c58.jpg 120w, images/2f1bcb08-6e65-5e30-929c-c2b0448ba5cb-f244bebc52172d82a68b84cd9a1eab7c7a4fa4fec57b14adb53b5ab12e8d9c58.jpg 192w, images/2f1bcb08-6e65-5e30-929c-c2b0448ba5cb-f244bebc52172d82a68b84cd9a1eab7c7a4fa4fec57b14adb53b5ab12e8d9c58.jpg 300w, images/2f1bcb08-6e65-5e30-929c-c2b0448ba5cb-f244bebc52172d82a68b84cd9a1eab7c7a4fa4fec57b14adb53b5ab12e8d9c58.jpg 420w, images/2f1bcb08-6e65-5e30-929c-c2b0448ba5cb-f244bebc52172d82a68b84cd9a1eab7c7a4fa4fec57b14adb53b5ab12e8d9c58.jpg 640w" sizes="(max-width: 320px) 80px, (max-width: 480px) 120px, (max-width: 768px) 192px, (max-width: 1200px) 300px, (max-width: 1680px) 420px, 640px" src="./images/2f1bcb08-6e65-5e30-929c-c2b0448ba5cb-f244bebc52172d82a68b84cd9a1eab7c7a4fa4fec57b14adb53b5ab12e8d9c58.jpg" srcset="images/2f1bcb08-6e65-5e30-929c-c2b0448ba5cb-f244bebc52172d82a68b84cd9a1eab7c7a4fa4fec57b14adb53b5ab12e8d9c58.jpg 80w, images/2f1bcb08-6e65-5e30-929c-c2b0448ba5cb-f244bebc52172d82a68b84cd9a1eab7c7a4fa4fec57b14adb53b5ab12e8d9c58.jpg 120w, images/2f1bcb08-6e65-5e30-929c-c2b0448ba5cb-f244bebc52172d82a68b84cd9a1eab7c7a4fa4fec57b14adb53b5ab12e8d9c58.jpg 192w, images/2f1bcb08-6e65-5e30-929c-c2b0448ba5cb-f244bebc52172d82a68b84cd9a1eab7c7a4fa4fec57b14adb53b5ab12e8d9c58.jpg 300w, images/2f1bcb08-6e65-5e30-929c-c2b0448ba5cb-f244bebc52172d82a68b84cd9a1eab7c7a4fa4fec57b14adb53b5ab12e8d9c58.jpg 420w, images/2f1bcb08-6e65-5e30-929c-c2b0448ba5cb-f244bebc52172d82a68b84cd9a1eab7c7a4fa4fec57b14adb53b5ab12e8d9c58.jpg 640w"/></div><div class="columns__text"><strong class="columns__title h4">1. Pick and Choose your games for rent</strong><div class="columns__description bq-content rx-content"><p>Choose a maximum of 5 games to rent out from our diverse  collection, catering to all age groups, and add them to your cart. </p></div></div></div><div class="columns__item" id="column_999507"><div class="columns__image-wrapper"><img alt="" class="columns__image ls-is-cached lazyloaded" data-src="images/a7ccef4a-380f-58cc-a13a-7abd393492d1-0e417bf140a9cb977b9e3b58e8736b87530d81e27cf238c8c24e6be7960eb516.jpg" data-srcset="images/a7ccef4a-380f-58cc-a13a-7abd393492d1-0e417bf140a9cb977b9e3b58e8736b87530d81e27cf238c8c24e6be7960eb516.jpg 80w, images/a7ccef4a-380f-58cc-a13a-7abd393492d1-0e417bf140a9cb977b9e3b58e8736b87530d81e27cf238c8c24e6be7960eb516.jpg 120w, images/a7ccef4a-380f-58cc-a13a-7abd393492d1-0e417bf140a9cb977b9e3b58e8736b87530d81e27cf238c8c24e6be7960eb516.jpg 192w, images/a7ccef4a-380f-58cc-a13a-7abd393492d1-0e417bf140a9cb977b9e3b58e8736b87530d81e27cf238c8c24e6be7960eb516.jpg 300w, images/a7ccef4a-380f-58cc-a13a-7abd393492d1-0e417bf140a9cb977b9e3b58e8736b87530d81e27cf238c8c24e6be7960eb516.jpg 420w, images/a7ccef4a-380f-58cc-a13a-7abd393492d1-0e417bf140a9cb977b9e3b58e8736b87530d81e27cf238c8c24e6be7960eb516.jpg 640w" sizes="(max-width: 320px) 80px, (max-width: 480px) 120px, (max-width: 768px) 192px, (max-width: 1200px) 300px, (max-width: 1680px) 420px, 640px" src="./images/a7ccef4a-380f-58cc-a13a-7abd393492d1-0e417bf140a9cb977b9e3b58e8736b87530d81e27cf238c8c24e6be7960eb516.jpg" srcset="images/a7ccef4a-380f-58cc-a13a-7abd393492d1-0e417bf140a9cb977b9e3b58e8736b87530d81e27cf238c8c24e6be7960eb516.jpg 80w, images/a7ccef4a-380f-58cc-a13a-7abd393492d1-0e417bf140a9cb977b9e3b58e8736b87530d81e27cf238c8c24e6be7960eb516.jpg 120w, images/a7ccef4a-380f-58cc-a13a-7abd393492d1-0e417bf140a9cb977b9e3b58e8736b87530d81e27cf238c8c24e6be7960eb516.jpg 192w, images/a7ccef4a-380f-58cc-a13a-7abd393492d1-0e417bf140a9cb977b9e3b58e8736b87530d81e27cf238c8c24e6be7960eb516.jpg 300w, images/a7ccef4a-380f-58cc-a13a-7abd393492d1-0e417bf140a9cb977b9e3b58e8736b87530d81e27cf238c8c24e6be7960eb516.jpg 420w, images/a7ccef4a-380f-58cc-a13a-7abd393492d1-0e417bf140a9cb977b9e3b58e8736b87530d81e27cf238c8c24e6be7960eb516.jpg 640w"/></div><div class="columns__text"><strong class="columns__title h4">2. Select the Dates for renting out</strong><div class="columns__description bq-content rx-content"><p>Choose the date you would like your rental to begin, and the games are reserved for the next 5 days from your start date, exclusively for you.</p></div></div></div><div class="columns__item" id="column"><div class="columns__image-wrapper"><img alt="" class="columns__image ls-is-cached lazyloaded" data-src="images/5f938306-0d58-5ada-ae18-ad1be57b2d35-d72a624045c598e5d2db1b67694faff408857bf0ec53b7ae4b966cf3f34430bb.jpg" data-srcset="images/5f938306-0d58-5ada-ae18-ad1be57b2d35-d72a624045c598e5d2db1b67694faff408857bf0ec53b7ae4b966cf3f34430bb.jpg 80w, images/5f938306-0d58-5ada-ae18-ad1be57b2d35-d72a624045c598e5d2db1b67694faff408857bf0ec53b7ae4b966cf3f34430bb.jpg 120w, images/5f938306-0d58-5ada-ae18-ad1be57b2d35-d72a624045c598e5d2db1b67694faff408857bf0ec53b7ae4b966cf3f34430bb.jpg 192w, images/5f938306-0d58-5ada-ae18-ad1be57b2d35-d72a624045c598e5d2db1b67694faff408857bf0ec53b7ae4b966cf3f34430bb.jpg 300w, images/5f938306-0d58-5ada-ae18-ad1be57b2d35-d72a624045c598e5d2db1b67694faff408857bf0ec53b7ae4b966cf3f34430bb.jpg 420w, images/5f938306-0d58-5ada-ae18-ad1be57b2d35-d72a624045c598e5d2db1b67694faff408857bf0ec53b7ae4b966cf3f34430bb.jpg 640w" sizes="(max-width: 320px) 80px, (max-width: 480px) 120px, (max-width: 768px) 192px, (max-width: 1200px) 300px, (max-width: 1680px) 420px, 640px" src="./images/5f938306-0d58-5ada-ae18-ad1be57b2d35-d72a624045c598e5d2db1b67694faff408857bf0ec53b7ae4b966cf3f34430bb.jpg" srcset="images/5f938306-0d58-5ada-ae18-ad1be57b2d35-d72a624045c598e5d2db1b67694faff408857bf0ec53b7ae4b966cf3f34430bb.jpg 80w, images/5f938306-0d58-5ada-ae18-ad1be57b2d35-d72a624045c598e5d2db1b67694faff408857bf0ec53b7ae4b966cf3f34430bb.jpg 120w, images/5f938306-0d58-5ada-ae18-ad1be57b2d35-d72a624045c598e5d2db1b67694faff408857bf0ec53b7ae4b966cf3f34430bb.jpg 192w, images/5f938306-0d58-5ada-ae18-ad1be57b2d35-d72a624045c598e5d2db1b67694faff408857bf0ec53b7ae4b966cf3f34430bb.jpg 300w, images/5f938306-0d58-5ada-ae18-ad1be57b2d35-d72a624045c598e5d2db1b67694faff408857bf0ec53b7ae4b966cf3f34430bb.jpg 420w, images/5f938306-0d58-5ada-ae18-ad1be57b2d35-d72a624045c598e5d2db1b67694faff408857bf0ec53b7ae4b966cf3f34430bb.jpg 640w"/></div><div class="columns__text"><strong class="columns__title h4">3. Complete Payment to Confirm Your Reservation</strong><div class="columns__description bq-content rx-content"><p>Proceed to checkout, select your preferred delivery option, and make an online payment to secure your reservation. You can either pick up your games or await their delivery to start enjoying.</p></div></div></div></div>
      </div>
      </section>
      <section class="text" data-section="true" data-section-key="text_420172" id="section-text_420172"><link href="./images/text-c69cfc7f7c4c0e9119e001940ed9a7c979af67e4de966e906b6338580a792035.css" rel="stylesheet" type="text/css"/>
        <div class="text__wrapper palette-three text__wrapper--padding-top text__wrapper--padding-bottom" id="text-text_420172" style="--padding-top: 24px;--padding-bottom: 24px;--padding-top-mobile: 18px;--padding-bottom-mobile: 18px;--text-align: left;">
        <div class="text__container container"><div class="text__content bq-content rx-content"><p>Effortlessly reserve our games. For additional information, refer to our Process Handout and Rental Agreement in the Discover Further section. Explore the FAQ section for answers to common queries, and feel free to reach out if you have any further questions!<br/></p></div></div>
        </div>
        </section>

  <!-- Footer -->
  <footer class="bg-dark text-white mt-5 p-4 text-center">
    &copy; 2023 GameRental. All rights reserved.
  </footer>

  <!-- Scripts -->
  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/11.2.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.2.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.2.0/firebase-database-compat.js"></script>
  <!-- jQuery and Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <!-- Flatpickr JS -->
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <!-- Custom JS -->
  <script>
    // Your web app's Firebase configuration
    const firebaseConfig = {
        apiKey: "AIzaSyB7yP6YD0oze6lo14u14aBKKVI8jBelHbc",
    authDomain: "gaming-rental-site.firebaseapp.com",
    databaseURL: "https://gaming-rental-site-default-rtdb.firebaseio.com",
    projectId: "gaming-rental-site",
    storageBucket: "gaming-rental-site.firebasestorage.app",
    messagingSenderId: "573901873327",
    appId: "1:573901873327:web:949bea4a588b6f9a37745a"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const database = firebase.database();

    // Initialize Flatpickr date pickers
   // flatpickr("#rent-date", { dateFormat: "Y-m-d" });
   // flatpickr("#return-date", { dateFormat: "Y-m-d" });
// Initialize Flatpickr date pickers with future dates only
flatpickr("#rent-date", { dateFormat: "Y-m-d", minDate: "today" });
flatpickr("#return-date", { dateFormat: "Y-m-d", minDate: "today" });

let logoutTimer; // Timer for automatic logout

    // Open the sign-in modal
    function openAuthModal() {
      $('#signInModal').modal('show');
    }

    // Show sign-up modal
    function showSignUp() {
      $('#signInModal').modal('hide');
      $('#signUpModal').modal('show');
    }

    // Sign up function
    function signUp() {
  const email = document.getElementById('signup-email').value;
  const password = document.getElementById('signup-password').value;
  const name = document.getElementById('signup-name').value;
  const phone = document.getElementById('signup-phone').value;

  auth.createUserWithEmailAndPassword(email, password)
    .then(userCredential => {
      const userId = userCredential.user.uid;

      // Store user profile information in the database
      database.ref(`users/${userId}`).set({
        email: email,
        name: name,
        phone: phone
      })
      .then(() => {
        // Data saved successfully!
        $('#signUpModal').modal('hide');
        updateAuthUI();
        alert('Signed up successfully!');
      })
      .catch(error => {
        console.error('Error saving user data:', error);
        alert('Error saving user data: ' + error.message);
      });
    })
    .catch(error => {
      console.error('Error signing up:', error);
      alert(error.message);
    });
}


    // Sign in function
    function signIn() {
      const email = document.getElementById('signin-email').value;
      const password = document.getElementById('signin-password').value;

      auth.signInWithEmailAndPassword(email, password)
        .then(userCredential => {
          $('#signInModal').modal('hide');
          updateAuthUI();
        })
        .catch(error => {
          console.error('Error signing in:', error);
          alert('Invalid email or password.');
        });
    }

    // Sign out function
    function signOut() {
      auth.signOut()
        .then(() => {
          updateAuthUI();
        })
        .catch(error => {
          console.error('Error signing out:', error);
        });
    }

    // Update the navigation bar based on authentication state
    // Update the navigation bar based on authentication state
    function updateAuthUI() {
      const user = auth.currentUser;
      const authButton = document.getElementById('auth-button');
      const userNameDisplay = document.getElementById('user-name-display');

      if (user) {
        // Fetch user's name from the database
        database.ref(`users/${user.uid}`).once('value')
          .then(snapshot => {
            const userInfo = snapshot.val();
            const userName = userInfo && userInfo.name ? userInfo.name : user.email;

            // Display user's name
            userNameDisplay.textContent = `Welcome, ${userName}`;
          })
          .catch(error => {
            console.error('Error fetching user name:', error);
            userNameDisplay.textContent = `Welcome, ${user.email}`;
          });

        authButton.textContent = 'Logout';
        authButton.onclick = signOut;

        // Set up automatic logout after 10 minutes
        clearTimeout(logoutTimer);
        logoutTimer = setTimeout(() => {
          alert('You have been logged out due to inactivity.');
          signOut();
        }, 10 * 60 * 1000); // 10 minutes in milliseconds
      } else {
        userNameDisplay.textContent = '';
        authButton.textContent = 'Sign In';
        authButton.onclick = openAuthModal;

        // Clear the logout timer
        clearTimeout(logoutTimer);
      }
    }

    // Monitor authentication state
    auth.onAuthStateChanged(user => {
      updateAuthUI();
    });

    // Reset logout timer on user interaction
    function resetLogoutTimer() {
      if (auth.currentUser) {
        clearTimeout(logoutTimer);
        logoutTimer = setTimeout(() => {
          alert('You have been logged out due to inactivity.');
          signOut();
        }, 10 * 60 * 1000);
      }
    }

        // Listen for user interactions to reset logout timer Added below section in DOMContent
       /*  ['click', 'mousemove', 'keydown', 'scroll', 'touchstart'].forEach(event => {
      document.addEventListener(event, resetLogoutTimer);
    }); */

    document.addEventListener('DOMContentLoaded', () => {
  const agreeTermsCheckbox = document.getElementById('agree-terms');
  const checkoutButton = document.getElementById('checkout-button');

  // Enable or disable the checkout button based on checkbox state
  agreeTermsCheckbox.addEventListener('change', () => {
    checkoutButton.disabled = !agreeTermsCheckbox.checked;
  });

  // Event listeners for user activity
  ['click', 'mousemove', 'keydown', 'scroll', 'touchstart'].forEach(event => {
    document.addEventListener(event, resetLogoutTimer);
  });

  /* // Load active rentals after user authentication
  firebase.auth().onAuthStateChanged(user => {
    if (user) {
      loadActiveRentals();
    }
  }); */
});




  //  document.addEventListener('DOMContentLoaded', () => {
  // const agreeTermsCheckbox = document.getElementById('agree-terms');
  // const checkoutButton = document.getElementById('checkout-button');

  // // Enable or disable the checkout button based on checkbox state
  // agreeTermsCheckbox.addEventListener('change', () => {
  //   checkoutButton.disabled = !agreeTermsCheckbox.checked;
  // }); 

    // Load available games based on selected dates
    function loadAvailableGames() {
  // Check if the user is logged in
  const user = auth.currentUser;
  if (!user) {
    alert('Please sign in to rent a game.');
    return;
  }
  const rentDate = document.getElementById('rent-date').value;
  const returnDate = document.getElementById('return-date').value;

  // Validate dates
  if (!rentDate || !returnDate) {
    alert('Please select both rental and return dates.');
    return;
  }
  if (rentDate > returnDate) {
    alert('Return date must be after rental date.');
    return;
  }
  // Calculate rental period in days
  calculateRentalDays();
  // Clear previous results
  //document.getElementById('game-list').innerHTML = '';
document.getElementById('genre-tabContent').innerHTML = '';
  // Fetch games and orders from Firebase
  fetchAvailableGames(rentDate, returnDate);
}



/* function fetchAvailableGames(rentDate, returnDate) {
  // Fetch all games
  database.ref('games').once('value')
    .then(gamesSnapshot => {
      const games = gamesSnapshot.val() || {};
      const gameList = [];

      // Fetch all orders
      database.ref('orders').once('value')
        .then(ordersSnapshot => {
          const orders = ordersSnapshot.val() || {};

          // Identify games that are rented out during the selected period
          const unavailableGameIds = new Set();
          for (const orderId in orders) {
            const order = orders[orderId];
            order.items.forEach(item => {
              if (
                order.status === 'active' &&
                item.status !== 'returned' &&
                !(
                  returnDate < order.rentDate ||
                  rentDate > order.returnDate
                )
              ) {
                unavailableGameIds.add(item.gameId);
              }
            });
          }

          // Filter available games
          for (const gameId in games) {
            if (!unavailableGameIds.has(gameId) && games[gameId].available) {
              const game = games[gameId];
              game.id = gameId; // Store the game ID
              gameList.push(game);
            }
          }

          // Display the games
          displayAvailableGames(gameList);
        });
    })
    .catch(error => {
      console.error('Error fetching games:', error);
    });
}
 */

 function fetchAvailableGames(rentDateStr, returnDateStr) {
  // Convert dates using dayjs
  const rentDate = dayjs(rentDateStr);
  const returnDate = dayjs(returnDateStr);

  // Fetch all games
  database.ref('games').once('value')
    .then(gamesSnapshot => {
      const games = gamesSnapshot.val() || {};

      // Fetch all orders
      database.ref('orders').once('value')
        .then(ordersSnapshot => {
          const orders = ordersSnapshot.val() || {};

          // Initialize rented quantities map
          const rentedQuantities = {};

          // Calculate rented quantities
          for (const orderId in orders) {
            const order = orders[orderId];
            const orderRentDate = dayjs(order.rentDate);
            const orderReturnDate = dayjs(order.returnDate);

            const isOverlapping = order.status === 'active' && !(
              returnDate.isBefore(orderRentDate, 'day') || rentDate.isAfter(orderReturnDate, 'day')
            );

            if (isOverlapping) {
              order.items.forEach(item => {
                if (item.status !== 'returned') {
                  const gameId = item.gameId;
                  rentedQuantities[gameId] = (rentedQuantities[gameId] || 0) + 1;
                }
              });
            }
          }

          // Prepare available games list
          const gameList = [];
          for (const gameId in games) {
            const game = games[gameId];

            const totalQuantity = game.totalQuantity || game.quantity || 0;
            const rentedQuantity = rentedQuantities[gameId] || 0;
            const availableQuantity = totalQuantity - rentedQuantity;

            // Output for debugging
            console.log(`Game: ${game.name}, Total Qty: ${totalQuantity}, Rented Qty: ${rentedQuantity}, Available Qty: ${availableQuantity}`);

            if (availableQuantity > 0) {
              game.id = gameId;
              game.totalQuantity = totalQuantity;
              game.availableQuantity = availableQuantity;
              gameList.push(game);
            }
          }

          // After you have the gameList (available games), extract genres
  const genresSet = new Set();
  gameList.forEach(game => {
    if (game.genre) {
      genresSet.add(game.genre);
    }
  });
  // Convert the set to an array and sort it
  const genres = Array.from(genresSet).sort();

  // Now, proceed to display the genres and games
  displayGenreTabs(genres);
  displayAvailableGamesByGenre(gameList, genres);

          // Display the games
          //displayAvailableGames(gameList);
        })
        .catch(error => {
          console.error('Error fetching orders:', error);
        });
    })
    .catch(error => {
      console.error('Error fetching games:', error);
    });
}

// Function to display genre tabs
function displayGenreTabs(genres) {
  const genreTabs = document.getElementById('genre-tabs');
  genreTabs.innerHTML = ''; // Clear previous tabs

  // Add "All" tab
  genreTabs.innerHTML += `
    <li class="nav-item">
      <a class="nav-link active" id="genre-tab-all" data-toggle="tab" href="#genre-all" role="tab" aria-controls="genre-all" aria-selected="true">All</a>
    </li>
  `;

  // Add tabs for each genre
  genres.forEach((genre, index) => {
    genreTabs.innerHTML += `
      <li class="nav-item">
        <a class="nav-link" id="genre-tab-${index}" data-toggle="tab" href="#genre-${index}" role="tab" aria-controls="genre-${index}" aria-selected="false">${genre}</a>
      </li>
    `;
  });
}

// Function to display available games by genre
function displayAvailableGamesByGenre(games, genres) {
  const tabContent = document.getElementById('genre-tabContent');
  tabContent.innerHTML = ''; // Clear previous content

  // All games tab pane
  let allGamesContent = '<div class="row">';
  games.forEach(game => {
    allGamesContent += generateGameCard(game);
  });
  allGamesContent += '</div>';

  tabContent.innerHTML += `
    <div class="tab-pane fade show active" id="genre-all" role="tabpanel" aria-labelledby="genre-tab-all">
      ${allGamesContent}
    </div>
  `;

  // Games by genre
  genres.forEach((genre, index) => {
    let genreGamesContent = '<div class="row">';
    games.forEach(game => {
      if (game.genre === genre) {
        genreGamesContent += generateGameCard(game);
      }
    });
    genreGamesContent += '</div>';

    tabContent.innerHTML += `
      <div class="tab-pane fade" id="genre-${index}" role="tabpanel" aria-labelledby="genre-tab-${index}">
        ${genreGamesContent}
      </div>
    `;
  });
}

// Helper function to generate a game card HTML
function generateGameCard(game) {
  return `
    <div class="col-md-3 game-card">
      <div class="card h-100">
        <img src="${game.imageUrl}" class="card-img-top" alt="${game.name}">
        <div class="card-body d-flex flex-column">
          <h5 class="card-title">${game.name}</h5>
          <p class="card-text">Genre: ${game.genre}</p>
          <p class="card-text">Available Copies: ${game.availableQuantity}</p>
          <p class="card-text">Price: $${game.price}</p>
          <button class="btn btn-primary mt-auto" onclick="addToCart('${game.id}', '${game.name}', '${game.imageUrl}', '${game.genre}', ${game.price})">Add to Cart</button>
        </div>
      </div>
    </div>
  `;
}






 function displayAvailableGames(games) {
  const gameListDiv = document.getElementById('game-list');
  gameListDiv.innerHTML = ''; // Clear previous content

  if (games.length === 0) {
    gameListDiv.innerHTML = '<p class="col-12 text-center">No games available for the selected dates.</p>';
    return;
  }

  games.forEach(game => {
    const gameCard = document.createElement('div');
    gameCard.className = 'col-md-3 game-card';

    gameCard.innerHTML = `
      <div class="card h-100">
        <img src="${game.imageUrl}" class="card-img-top" alt="${game.name}">
        <div class="card-body d-flex flex-column">
          <h5 class="card-title">${game.name}</h5>
          <p class="card-text">Genre: ${game.genre}</p>
          <p class="card-text">Total Copies: ${game.totalQuantity}</p>
          <p class="card-text">Available Copies: ${game.availableQuantity}</p>
          <p class="card-text">Price: $${game.price}</p>
          <button class="btn btn-primary mt-auto" onclick="addToCart('${game.id}', '${game.name}', '${game.imageUrl}', '${game.genre}', ${game.price})">Add to Cart</button>
        </div>
      </div>
    `;

    gameListDiv.appendChild(gameCard);
  });
}



let cart = [];

function addToCart(gameId, name, imageUrl, genre, price) {
  if (cart.some(item => item.gameId === gameId)) {
    alert('This game is already in your cart.');
    return;
  }
  // Calculate cost for this game
  const rentalDays = calculateRentalDays();
  const totalCost = price * rentalDays;

  cart.push({ gameId, name, imageUrl, genre, price, totalCost });
  updateCartCount();
  alert('Game added to cart.');
  //updateCartTotal(); // Update total cost
}

function calculateRentalDays() {
  const rentDateValue = document.getElementById('rent-date').value;
  const returnDateValue = document.getElementById('return-date').value;

  if (!rentDateValue || !returnDateValue) {
    return 0;
  }

  const rentDate = dayjs(rentDateValue);
  const returnDate = dayjs(returnDateValue);
  const rentalDays = returnDate.diff(rentDate, 'day') + 1; // Include both rental and return date

  return rentalDays > 0 ? rentalDays : 0;
}

// Update cart item count
function updateCartCount() {
  document.getElementById('cart-count').textContent = cart.length;
}

// Show cart contents
function showCart() {
  const cartItemsDiv = document.getElementById('cart-items');
  cartItemsDiv.innerHTML = '';

  if (cart.length === 0) {
    cartItemsDiv.innerHTML = '<p>Your cart is empty.</p>';
  } else {
    const rentalDays = calculateRentalDays();
    if (rentalDays === 0) {
      alert('Please select valid rental and return dates before viewing the cart.');
      return;
    }

    let overallTotal = 0;

    cart.forEach((item, index) => {
      // Recalculate total cost in case rental dates have changed
      const totalCost = item.price * rentalDays;
      item.totalCost = totalCost;
      overallTotal += totalCost;

      const cartItem = document.createElement('div');
      cartItem.className = 'media mb-3';
      cartItem.innerHTML = `
        <img src="${item.imageUrl}" class="mr-3" alt="${item.name}" style="width: 64px; height: 64px; object-fit: cover;">
        <div class="media-body">
          <h5 class="mt-0">${item.name}</h5>
          <p>Genre: ${item.genre}</p>
          <p>Price per Day: $${item.price}</p>
          <p>Total Cost: $${totalCost.toFixed(2)}</p>
          <button class="btn btn-danger btn-sm" onclick="removeFromCart(${index})">Remove</button>
        </div>
      `;

      cartItemsDiv.appendChild(cartItem);
    });

    // Display overall total cost
    const totalDiv = document.createElement('div');
    totalDiv.className = 'text-right';
    totalDiv.innerHTML = `<h5>Total Cost: $${overallTotal.toFixed(2)}</h5>`;
    cartItemsDiv.appendChild(totalDiv);
  }

  $('#cartModal').modal('show');
}


// Remove a game from the cart
function removeFromCart(index) {
  cart.splice(index, 1);
  updateCartCount();
  showCart();
}


// Proceed to checkout
function checkout() {
  $('#cartModal').modal('hide');

  const user = auth.currentUser;
  if (!user) {
    alert('Please sign in to proceed with the checkout.');
    return;
  }
  const agreeTermsCheckbox = document.getElementById('agree-terms');
  if (!agreeTermsCheckbox.checked) {
    alert('Please agree to the terms and conditions before proceeding.');
    return;
  }

  const rentDate = document.getElementById('rent-date').value;
  const returnDate = document.getElementById('return-date').value;

  const rentalDays = calculateRentalDays();
  if (rentalDays === 0) {
    alert('Please select valid rental and return dates.');
    return;
  }

  validateCartAvailability(rentDate, returnDate)
    .then(allAvailable => {
      if (allAvailable) {
        // Calculate total cost
        let overallTotal = 0;
        cart.forEach(item => {
          item.totalCost = item.price * rentalDays;
          overallTotal += item.totalCost;
        });
        // Proceed to rent games
        rentGames(rentDate, returnDate, overallTotal);
      } else {
        alert('Some games in your cart are no longer available for the selected dates. They have been removed from your cart.');
        showCart();
      }
    })
    .catch(error => {
      console.error('Error during checkout:', error);
    });
}

document.getElementById('checkout-button').addEventListener('click', checkout);



 function validateCartAvailability(rentDate, returnDate) {
  return new Promise((resolve, reject) => {
    // Fetch the latest game quantities
    database.ref('games').once('value')
      .then(gamesSnapshot => {
        const games = gamesSnapshot.val() || {};
        let allAvailable = true;

        cart.forEach(item => {
          const game = games[item.gameId];
          if (!game || game.quantity <= 0) {
            // Remove item from cart if not available
            allAvailable = false;
            cart = cart.filter(cartItem => cartItem.gameId !== item.gameId);
          }
        });

        updateCartCount();
        resolve(allAvailable);
      })
      .catch(error => reject(error));
  });
}



 function rentGames(rentDate, returnDate, overallTotal) {
  const user = auth.currentUser;

  database.ref(`users/${user.uid}`).once('value')
    .then(userSnapshot => {
      const userInfo = userSnapshot.val();

      if (!userInfo) {
        throw new Error('User profile information not found.');
      }

      const rentalDays = calculateRentalDays();

      // Prepare order data
      const orderData = {
        userId: user.uid,
        userEmail: userInfo.email,
        userName: userInfo.name || '',
        userPhone: userInfo.phone || '',
        rentDate: rentDate,
        returnDate: returnDate,
        rentalDays: rentalDays,
        status: 'active',
        totalCost: overallTotal,
        items: []
      };

      // Fetch the latest quantities of the games in the cart
      const gameIds = cart.map(item => item.gameId);
      return database.ref('games').once('value')
        .then(gamesSnapshot => {
          const gamesData = gamesSnapshot.val() || {};
          const updates = {}; // To hold all database updates

          // Check availability and prepare updates
          cart.forEach(item => {
            const game = gamesData[item.gameId];
            if (!game) {
              throw new Error(`Game '${item.name}' not found.`);
            }

            const currentQuantity = game.quantity || 0;
            if (currentQuantity <= 0) {
              throw new Error(`Game '${item.name}' is out of stock.`);
            }

            // Decrement quantity
            const newQuantity = currentQuantity - 1;
            updates[`games/${item.gameId}/quantity`] = newQuantity;

            // Update 'available' status if quantity is zero
            if (newQuantity === 0) {
              updates[`games/${item.gameId}/available`] = false;
            }

            // Prepare order items
            orderData.items.push({
              gameId: item.gameId,
              gameName: item.name,
              pricePerDay: item.price,
              totalCost: item.totalCost
            });

            // Create individual rental records in updates
            const rentalRef = database.ref('rentals').push();
            updates[`rentals/${rentalRef.key}`] = {
              gameId: item.gameId,
              userId: user.uid,
              userEmail: userInfo.email,
              userName: userInfo.name || '',
              userPhone: userInfo.phone || '',
              rentDate: rentDate,
              returnDate: returnDate,
              status: 'active',
              totalCost: item.totalCost
            };
          });

          // Create order record in updates
          const orderRef = database.ref('orders').push();
          updates[`orders/${orderRef.key}`] = orderData;

          // Apply all updates atomically
          return database.ref().update(updates);
        });
    })
    .then(() => {
      alert('Games rented successfully! An invoice has been sent to your email.');
      cart = [];
      updateCartCount();
      loadAvailableGames();
    })
    .catch(error => {
      console.error('Error renting games:', error);
      alert(error.message || 'An error occurred while renting the games.');
    });
}



    function rentGame(gameId) {
  // Check if the user is logged in
  const user = auth.currentUser;
  if (!user) {
    alert('Please sign in to rent a game.');
    return;
  }

  console.log('User is signed in:', user.uid);

  const rentDate = document.getElementById('rent-date').value;
  const returnDate = document.getElementById('return-date').value;

  // Fetch user profile information
  console.log(`Fetching user info for UID: ${user.uid}`);
  database.ref(`users/${user.uid}`).once('value')
    .then(userSnapshot => {
      const userInfo = userSnapshot.val();
      console.log('User info fetched:', userInfo);

      if (!userInfo) {
        throw new Error('User profile information not found.');
      }

      // Create the rental record including user profile information
      const rentalRef = database.ref('rentals').push();
      rentalRef.set({
        gameId: gameId,
        userId: user.uid,
        userEmail: userInfo.email,
        userName: userInfo.name || '',
        userPhone: userInfo.phone || '',
        rentDate: rentDate,
        returnDate: returnDate,
        status: 'active'
      })
      .then(() => {
        alert('Game rented successfully!');
        loadAvailableGames(); // Refresh the available games
      })
      .catch(error => {
        console.error('Error renting game:', error);
        alert('An error occurred while renting the game.');
      });
    })
    .catch(error => {
      console.error('Error fetching user info:', error);
      alert('An error occurred while fetching user information.');
    });
}


    // Search all games
    function searchAllGames() {
      const searchTerm = document.getElementById('search-input').value.trim().toLowerCase();

      if (!searchTerm) {
        alert('Please enter a search term.');
        return;
      }

      // Clear previous results
      document.getElementById('game-list').innerHTML = '';

      // Fetch all games
      database.ref('games').once('value')
        .then(gamesSnapshot => {
          const games = gamesSnapshot.val() || {};
          const filteredGames = [];

          for (const gameId in games) {
            const game = games[gameId];
            if (game.name.toLowerCase().includes(searchTerm) || (game.genre && game.genre.toLowerCase().includes(searchTerm))) {
              game.id = gameId;
              filteredGames.push(game);
            }
          }

          if (filteredGames.length === 0) {
            document.getElementById('game-list').innerHTML = '<p class="col-12 text-center">No games found matching your search.</p>';
          } else {
            displayAllGames(filteredGames);
          }
        })
        .catch(error => {
          console.error('Error searching games:', error);
        });
    }

    function displayAllGames(games) {
      const gameListDiv = document.getElementById('game-list');

      games.forEach(game => {
        const gameCard = document.createElement('div');
        gameCard.className = 'col-md-3 game-card';

        gameCard.innerHTML = `
          <div class="card h-100">
            <img src="${game.imageUrl}" class="card-img-top" alt="${game.name}">
            <div class="card-body d-flex flex-column">
              <h5 class="card-title">${game.name}</h5>
              <p class="card-text">Genre: ${game.genre}</p>
              <p class="card-text">Price: $${game.price}</p>
            </div>
          </div>
        `;

        gameListDiv.appendChild(gameCard);
      });
    }

    function generateInvoice(overallTotal) {
  // Create or update the invoice modal
  let invoiceModal = document.getElementById('invoiceModal');
  if (!invoiceModal) {
    invoiceModal = document.createElement('div');
    invoiceModal.id = 'invoiceModal';
    invoiceModal.className = 'modal fade';
    invoiceModal.tabIndex = -1;
    invoiceModal.role = 'dialog';
    invoiceModal.innerHTML = `
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Invoice</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
        
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body" id="invoice-content">
            <!-- Invoice content will be inserted here -->
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" onclick="printInvoice()">Print Invoice</button>
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    `;
    document.body.appendChild(invoiceModal);
  }

  // Build the invoice content
  const invoiceContent = document.getElementById('invoice-content');
  invoiceContent.innerHTML = ''; // Clear previous content

  let invoiceHTML = `
    <p>Thank you for your rental!</p>
    <table class="table">
      <thead>
        <tr>
          <th>Game</th>
          <th>Price per Day</th>
          <th>Days</th>
          <th>Total Cost</th>
        </tr>
      </thead>
      <tbody>
  `;

  const rentalDays = calculateRentalDays();

  cart.forEach(item => {
    invoiceHTML += `
      <tr>
        <td>${item.name}</td>
        <td>$${item.price.toFixed(2)}</td>
        <td>${rentalDays}</td>
        <td>$${item.totalCost.toFixed(2)}</td>
      </tr>
    `;
  });

  invoiceHTML += `
      </tbody>
    </table>
    <h5 class="text-right">Overall Total: $${overallTotal.toFixed(2)}</h5>
  `;

  invoiceContent.innerHTML = invoiceHTML;

  $('#invoiceModal').modal('show');
}





function generateInvoiceHtml(rentalData) {
  let gamesList = '';
  let totalAmount = 0;

  rentalData.games.forEach(game => {
    const gameTotal = game.price * game.quantity * rentalData.numberOfDays;
    totalAmount += gameTotal;

    gamesList += `
      <tr>
        <td>${game.title}</td>
        <td>${game.quantity}</td>
        <td>$${game.price.toFixed(2)}</td>
        <td>${rentalData.numberOfDays}</td>
        <td>$${gameTotal.toFixed(2)}</td>
      </tr>
    `;
  });

  return `
    <div style="font-family: Arial, sans-serif; color: #333;">
      <h2>Thank you for renting with GRICQUEST!</h2>
      <p>Dear ${rentalData.customerName},</p>
      <p>Here is the summary of your rental:</p>
      <table style="width: 100%; border-collapse: collapse;">
        <thead>
          <tr>
            <th style="border-bottom: 2px solid #ddd; text-align: left;">Game Title</th>
            <th style="border-bottom: 2px solid #ddd; text-align: left;">Quantity</th>
            <th style="border-bottom: 2px solid #ddd; text-align: left;">Price/Day</th>
            <th style="border-bottom: 2px solid #ddd; text-align: left;">Days</th>
            <th style="border-bottom: 2px solid #ddd; text-align: left;">Total</th>
          </tr>
        </thead>
        <tbody>
          ${gamesList}
          <tr>
            <td colspan="4" style="text-align: right; font-weight: bold;">Grand Total:</td>
            <td style="font-weight: bold;">$${totalAmount.toFixed(2)}</td>
          </tr>
        </tbody>
      </table>
      <p>Rental Period: ${rentalData.rentalDate} to ${rentalData.returnDate}</p>
      <p>If you have any questions, feel free to contact us at support@gricquest.com.</p>
      <p>Happy Gaming!</p>
      <p>The GRICQUEST Team</p>
    </div>
  `;
}




/* function printInvoice() {
  const invoiceContent = document.getElementById('invoice-content').innerHTML;
     const printWindow = window.open('', '', 'hei    t=600,width=800');

        printWindow) {
    var htmlContent = '<html><head><title>Invoice</title>';
    htmlContent += '<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">';
      htmlCon    nt += '<style>body { font-family: Arial, sans-serif; margin: 20px; }</style>';
    htmlContent += '</head><body>';
    htmlContent    = invoiceContent;
    htmlContent += '</bo    ></html>';

    printWindow.docum  ent.o  pen();
    printWindow.doc    ent.write(htmlContent);
    printWindow.document.close();

    printWindow.fo    s();

    printWindow.onload = function () {
      printWindow.pr    t();
      printWin      close();
    };
  } else {
    alert('Please allow pop       for this website to print the invoice.');
  }
}
 */
  </script>
</body>
</html>